{
  "name": "Sleetbubble",
  "image": "mcr.microsoft.com/devcontainers/base:ubuntu",

  "features": {
    "ghcr.io/devcontainers/features/docker-in-docker:2": {},
    "ghcr.io/devcontainers/features/node:1": {
      "version": "lts"
    }
  },

  "postCreateCommand": "wget -q https://dist.ipfs.tech/kubo/v0.31.0/kubo_v0.31.0_linux-amd64.tar.gz -O /tmp/ipfs.tar.gz && tar -xzf /tmp/ipfs.tar.gz -C /tmp && sudo bash /tmp/kubo/install.sh && rm -rf /tmp/kubo /tmp/ipfs.tar.gz && docker build -t sleetbubble-test-web /workspaces/sleet_test/test",

  "forwardPorts": [
    80, 81, 443, 444,
    5500, 8888,
    8080, 8081,
    5001, 5002,
    4001, 4002
  ],

  "portsAttributes": {
    "80":   { "label": "Main Web Player",     "onAutoForward": "notify", "visibility": "public" },
    "81":   { "label": "Node 2 Web Player",   "onAutoForward": "notify", "visibility": "public" },
    "5500": { "label": "Web Player",          "onAutoForward": "openBrowser", "visibility": "public" },
    "8888": { "label": "IPFS CORS Proxy",     "onAutoForward": "notify", "visibility": "public" },
    "443":  { "label": "HTTPS Main",          "onAutoForward": "silent", "visibility": "public" },
    "444":  { "label": "HTTPS Node 2",        "onAutoForward": "silent", "visibility": "public" },
    "8080": { "label": "IPFS Gateway Node 1", "onAutoForward": "notify", "visibility": "public" },
    "8081": { "label": "IPFS Gateway Node 2", "onAutoForward": "notify", "visibility": "public" },
    "5001": { "label": "IPFS API Node 1",     "onAutoForward": "silent", "visibility": "private" },
    "5002": { "label": "IPFS API Node 2",     "onAutoForward": "silent", "visibility": "private" },
    "4001": { "label": "IPFS Swarm Node 1",   "onAutoForward": "silent", "visibility": "public" },
    "4002": { "label": "IPFS Swarm Node 2",   "onAutoForward": "silent", "visibility": "public" }
  },

  "postStartCommand": "docker run -d --name sleetbubble-test-web --network sleet_test_default -p 5500:5500 -p 8888:8888 -v /workspaces/sleet_test/test:/app:ro --restart unless-stopped sleetbubble-test-web",

  "customizations": {
    "vscode": {
      "extensions": [
        "GitHub.copilot",
        "GitHub.vscode-pull-request-github",
        "GitHub.github-vscode-theme",
        "ms-vscode.vscode-websearchforcopilot",
        "vittee.liquidsoap",
        "naumovs.color-highlight",
        "IBM.output-colorizer",
        "MarkosTh09.color-picker",
        "docker.docker",
        "ms-azuretools.vscode-docker",
        "formulahendry.docker-explorer"
      ],
      "settings": {
        "workbench.colorTheme": "GitHub Dark",
        "github.copilot.enableWebSearch": true,

        "mcp": {
          "servers": {
            "deepwiki": {
              "type": "sse",
              "url": "https://mcp.deepwiki.com/sse"
            },

            "playwright": {
              "command": "npx",
              "args": [ "-y", "@playwright/mcp", "--browser", "chromium" ]
            }
          }
        }
      }
    }
  }
}